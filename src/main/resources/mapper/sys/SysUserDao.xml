<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.dfjinxin.modules.sys.dao.SysUserDao">
	<!-- 查询用户的所有权限 -->
	<select id="queryAllPerms" resultType="string">
		select m.menu_perm from pss_user_role_info ur
			LEFT JOIN pss_role_perm_info rm on ur.role_id = rm.role_id
			LEFT JOIN pss_menu_info m on rm.menu_id = m.menu_id
		where ur.user_id = #{userId}
	</select>

	<!-- 查询用户的所有菜单ID -->
	<select id="queryAllMenuId" resultType="long">
		select distinct rm.menu_id from pss_user_role_info ur
			LEFT JOIN pss_role_perm_info rm on ur.role_id = rm.role_id
		where ur.user_id = #{userId}
	</select>

	<!--根据用户名称查询用户信息-->
	<select id="queryByUserName" resultType="io.dfjinxin.modules.sys.entity.SysUserEntity">
		select * from pss_user_info where user_id = #{username}
	</select>

	<!--根据用户ID查询用户信息-->
	<select id="" resultType="io.dfjinxin.modules.sys.entity.SysUserEntity">

	</select>

	<!--新增 用户-->
	<insert id="insertUserData" parameterType="io.dfjinxin.modules.sys.entity.SysUserEntity">
		INSERT INTO pss_user_info(
		  user_id,
		  user_name,
		  user_pass,
		  user_real_name,
		  mbl_phone_no,
		  fix_tphone_no,
		  email,
		  user_status,
		  crte_date,
		  upd_date
      )VALUES (
      #{userId},
      #{userName},
      #{userPass},
      #{userRealName},
      #{mblPhoneNo},
      #{fixTphoneNo},
      #{email},
      #{userStatus},
      CURRENT_TIMESTAMP(),
      CURRENT_TIMESTAMP()
      )
	</insert>

  <!--更新用户数据-->
	<update id="updateUserData" parameterType="io.dfjinxin.modules.sys.entity.SysUserEntity">
		UPDATE pss_user_info
		SET (
		 user_name = #{userName},
		 user_pass = #{user_pass},
		 user_real_name = #{userRealName},
		 mbl_phone_no = #{mblPhoneNo},
		 fix_tphone_no = #{fixTphoneNo},
		 email = #{email},
		 user_status = #{userStatus},
		 upd_date = CURRENT_TIMESTAMP()
		)
		WHERE
		user_id = #{userId}
	</update>


	<delete id="deleteByUserName" >
		delete from pss_user_info where user_name = #{username}
	</delete>

</mapper>
